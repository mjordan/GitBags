# GitBags

A GitBag is a [Bag](https://tools.ietf.org/html/draft-kunze-bagit-05) that is contained within a Git repository. For example, for a Bag within a directory named 'mybagdir,' you have this:

```
mybagdir/
├── bag-info.txt
├── bagit.txt
├── data
│   ├── file1.txt
│   └── file2.txt
├── manifest-md5.txt
└── tagmanifest-md5.txt
```
By initializing a Git repo within the Bag directory, you get this:

```
mybagdir/
├── bag-info.txt
├── bagit.txt
├── data
│   ├── file1.txt
│   └── file2.txt
├── .git
│   ├── branches
│   ├── config
│   ├── description
│   ├── HEAD
│   ├── hooks
│   │   ├── applypatch-msg.sample
│   │   ├── commit-msg.sample
│   │   ├── post-update.sample
│   │   ├── pre-applypatch.sample
│   │   ├── pre-commit.sample
│   │   ├── prepare-commit-msg.sample
│   │   ├── pre-push.sample
│   │   ├── pre-rebase.sample
│   │   └── update.sample
│   ├── info
│   │   └── exclude
│   ├── objects
│   │   ├── info
│   │   └── pack
│   └── refs
│       ├── heads
│       └── tags
├── manifest-md5.txt
└── tagmanifest-md5.txt
```

## Why would you do this?

Several potential reasons:

1. you want to record all changes to the content of a Bag
1. you get a built-in tool for viewing the history of actions taken on a Bag: `git reflog show`
1. the Bag can be cloned using any of Git's transport mechanisms, facilitating easy duplication and synchronisation of Bags across networks and tracking of workflows using the reflog
1. Git's hooks offer a mechanism for logging to external services, email notifications, etc.

## Disadvantages

Some include:

1. since Git generates SHA1 checksums for all files, SHA1 checksums generated by BagIt tools are redundant (but see below)
2. Git operations such as diff are not practical on binary files
3. the size of a GitBag is larger than the equivalent non-Git Bag.

## Are GitBags destructive to the Bag contents?

No. Bags that contain .git directories validate. Also, a GitBag is just a Bag - it can be "removed" from the Git repo at any point simply by removing its .git directory. In this case, having those redundant SHA1 hashes around is good. 

## A sample workflow

In this example, I modify the contents of the GitBag's /data directory (it's payload). Before I do anything to the GitBag's contents, I clone the GitBag to create a working copy. Then, I simply update the payload and regnerate the Bag (or update its manifests). Then, I perform a `git commit` on the GitBag.

The steps I performed from within the GitBag's directory are:

[Edit/modify the payload files]
[Update the Bag's manifests]
`commit -am "Did something important to the payload."`

Later, I use `git log` or 'git reflog show` to see the history of actions on the Bag:

```
2215aa5 HEAD@{0}: commit: Updated the contents of the Bag.
3a7b3c0 HEAD@{1}: clone: from /home/mark/Documents/hacking/bagit/mybagdir/
```

 






